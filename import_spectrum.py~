# IMPORT_SPECTRUM.PY (STEFFAN RHYS THOMAS L4 PROJECT - .PY FILE 1)'
# POPIII STAR MODEL VARIABLES CAN BE CHANGED DIRECTLY BELOW, EXPLANATION OF PARAMS IN README

### VARIABLES (unchanged as of 07/10/25)  ###
ttt = 'ge0' #Options - ge0: no mass loss, mdt: with mass loss
imf = 'sal'
mup = '500'
low = "001"
sfh = 'is5'

n_single = 31 #SED of population (single plotting)

n_array = np.linspace(31,1030, 999, dtype='int') # SED (multiple plotting)


### MODULES ###
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.cm import ScalarMappable
from matplotlib.colors import Normalize
from astropy.io import ascii
import latex
import os

### PLOTTING PARAMS ###
plt.rcParams["font.size"] = 30
plt.rcParams["legend.fontsize"] = 30
plt.rcParams["figure.frameon"] = False
plt.rcParams["figure.titlesize"] = 16
plt.rcParams["text.usetex"] = True
plt.rcParams["figure.subplot.wspace"] = 0.03
plt.rcParams["legend.frameon"] = False
plt.rcParams["axes.linewidth"] = 1.75

### CONSTANTS USED ###
#SI UNITS
T_sun = 5772 #k'
c_m = 3*10**8 #m
T_100M = 10**(4.7) #k
M_sun_kg = 1.989*10**30
G = 6.67*10**(-11)

#non SI
kb = 1.38*10**(-16)
c = 3*10**10
h = 6.63*10**(-27)
pc = 3.08*10**18
AU = 1.496*10**13
d = 1 * AU
R_sun = 6.957*10**10
M_sun = 1.989*10**33

## MAIN FUNCTIONS ###

def import_data(n):
    #read data and determine if single or multiple files
    if n == 'single':
        file_loc = f"/home/steff/hsim/zackrisson_pop3_all/reionis_2010/pop3_{ttt}_{imf}_{mup}_{low}_{sfh}.{n_single}"
        if os.path.exists(file_loc):
            age = ascii.read(file_loc,format = 'csv', comment = '$',delimiter = '\s',data_start = 12, data_end = 13, names = ['preamble1', 'preamble2','3','4','5','6',' data'])
            age_data = age['6'][0]
            data = ascii.read(file_loc,guess = True, data_start = 0)
            wavelength = data['col1']
            flux_raw = data['col3']
            SED_flux = total_flux / (4*np.pi*(d**2)*M_sun)
    elif n == 'multi':
        age_data = np.array([])
        for i in range(len(n_array)):
            file_loc = f"/home/steff/hsim/zackrisson_pop3_all/reionis_2010/pop3_{ttt}_{imf}_{mup}_{low}_{sfh}.{n_array[i]}"
            if os.path.exists(file_loc):
                age = ascii.read(file_loc,format = 'csv', comment = '$',delimiter = '\s',data_start = 12, data_end = 13, names = ['preamble1', 'preamble2','3','4','5','6',' data'])
                age_data = age['6'][0]
                all_ages.append(age_data)
                data = ascii.read(file_loc,guess = True, data_start = 2)
                wavelength = data['col1']
                flux_raw = data['col3']
                SED_flux = total_flux / (4*np.pi*(d**2)*M_sun)
    
